<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>¬°Feliz Cumplea√±os, Darling! üéÇ‚ú®</title>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Variables de color por defecto (ser√°n sobrescritas por JavaScript) */
            --primary-light: #e0f7fa;
            --primary-dark: #00bcd4;
            --secondary-dark: #00897b;
            --accent-color: #e91e63;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Montserrat', sans-serif;
            background: linear-gradient(135deg, var(--primary-light) 0%, var(--primary-light) 25%, var(--primary-dark) 50%, var(--primary-dark) 75%, var(--primary-dark) 100%);
            color: #333;
            text-align: center;
            overflow-x: hidden;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle, var(--primary-dark) 1px, transparent 1px);
            background-size: 50px 50px;
            z-index: 0;
            pointer-events: none;
            opacity: 0.15;
        }

        .secret-message {
            position: fixed;
            top: 10px;
            left: 10px;
            font-size: 0.65rem;
            color: rgba(255, 255, 255, 0.5);
            font-weight: 300;
            z-index: 1;
            opacity: 0.5;
            letter-spacing: 1px;
        }

        .hysteresis-message {
            position: fixed;
            top: 40px; 
            left: 10px;
            font-size: 0.7rem;
            color: rgba(255, 255, 255, 0.7); 
            font-weight: 400;
            z-index: 1;
            opacity: 0.9;
            letter-spacing: 0.5px;
            pointer-events: none;
            transition: opacity 1s;
            text-align: left;
            max-width: 250px;
        }

        .hysteresis-message:hover {
            opacity: 1; 
        }

        .card-container {
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(240, 255, 255, 0.95));
            border-radius: 30px;
            box-shadow: 
                0 20px 60px color-mix(in srgb, var(--secondary-dark) 50%, transparent),
                0 0 100px color-mix(in srgb, var(--primary-dark) 50%, transparent),
                inset 0 1px 0 rgba(255, 255, 255, 0.9);
            padding: 50px 40px;
            max-width: 700px;
            width: 90%; 
            z-index: 10;
            animation: fadeInScale 2s ease-out;
            margin: 30px 20px;
            border: 3px solid color-mix(in srgb, var(--secondary-dark) 20%, transparent);
            position: relative;
            overflow: hidden;
        }

        .card-container::before, .card-container::after {
            content: 'üåü';
            position: absolute;
            font-size: 2rem;
            animation: sparkle 3s infinite;
            filter: drop-shadow(0 0 5px var(--primary-dark));
        }

        .card-container::before {
            top: 20px;
            left: 20px;
        }

        .card-container::after {
            bottom: 20px;
            right: 20px;
            animation-delay: 1.5s;
        }

        @keyframes sparkle {
            0%, 100% { opacity: 1; transform: scale(1) rotate(0deg); }
            50% { opacity: 0.5; transform: scale(1.2) rotate(180deg); }
        }

        h1 {
            font-family: 'Great Vibes', cursive;
            font-size: 5rem;
            background: linear-gradient(45deg, var(--secondary-dark), var(--primary-dark));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            text-shadow: 2px 2px 20px color-mix(in srgb, var(--secondary-dark) 50%, transparent);
            animation: titlePulse 4s infinite alternate;
            letter-spacing: 2px;
        }

        @keyframes titlePulse {
            0% { transform: scale(1); }
            100% { transform: scale(1.05); }
        }

        h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            color: var(--secondary-dark);
            margin-top: 5px;
            margin-bottom: 35px;
            letter-spacing: 3px;
            font-weight: 700;
            text-shadow: 1px 1px 10px color-mix(in srgb, var(--secondary-dark) 30%, transparent);
            position: relative;
        }

        h2::after {
            content: 'üéÇ';
            display: block;
            font-size: 1.5rem;
            color: var(--secondary-dark);
            margin-top: 10px;
            animation: heartBeat 1.5s infinite;
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            25% { transform: scale(1.1); }
            50% { transform: scale(1); }
        }

        p {
            font-size: 1.2rem;
            line-height: 2.0; 
            color: #444;
            max-width: 600px;
            /* AUMENTADO EL MARGEN BOTTOM PARA EVITAR SUPERPOSICI√ìN CON EL MAPA */
            margin: 0 auto 45px auto; 
            font-weight: 400;
            text-align: justify;
            text-align-last: center; 
            word-spacing: 0.05em; 
            letter-spacing: 0.01em; 
        }
        
        /* AJUSTE CLAVE PARA EL MAPA */
        .map-container {
            width: 100%;
            max-width: 500px;
            height: 250px; /* ALTURA FIJA PARA MAYOR CONSISTENCIA */
            position: relative;
            margin: 30px auto 10px auto; /* MENOS MARGEN ABAJO */
            background: linear-gradient(135deg, color-mix(in srgb, var(--primary-dark) 30%, transparent), color-mix(in srgb, var(--primary-light) 50%, transparent));
            border-radius: 20px;
            padding: 10px;
            box-shadow: 0 5px 20px color-mix(in srgb, var(--secondary-dark) 30%, transparent);
            border: 2px solid color-mix(in srgb, var(--secondary-dark) 20%, transparent);
        }
        
        .world-map {
            width: 100%;
            height: 100%;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            animation: mapPulse 4s infinite;
        }
        
        @keyframes mapPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.02); }
            100% { transform: scale(1); }
        }

        /* AJUSTE CLAVE: TEXTO DEL MAPA FUERA DEL CONTENEDOR PRINCIPAL */
        .map-text {
            text-align: center;
            margin: 15px auto 35px auto; /* M√ÅRGENES CLAROS PARA SEPARARSE DEL MAPA Y DEL MENSAJE FINAL */
            font-size: 1.1rem;
            color: var(--secondary-dark);
            font-weight: 600;
        }

        .signature {
            font-family: 'Great Vibes', cursive;
            font-size: 2.5rem;
            color: var(--secondary-dark);
            margin-top: 40px;
            line-height: 1.6;
        }

        /* ... (Estilos de flores y p√©talos sin cambios) ... */
        .flower {
            position: fixed;
            pointer-events: none;
            opacity: 0.6; 
            animation: fallFlower linear infinite;
            font-size: 40px; 
            filter: drop-shadow(2px 2px 3px color-mix(in srgb, var(--accent-color) 40%, transparent));
        }

        @keyframes fallFlower {
            0% { 
                transform: translateY(-120px) rotate(0deg) translateX(0); 
                opacity: 0.1; 
            }
            10% { opacity: 0.9; }
            50% { 
                transform: translateY(50vh) rotate(360deg) translateX(50px);
                opacity: 0.8;
            }
            100% { 
                transform: translateY(100vh) rotate(720deg) translateX(-30px); 
                opacity: 0.1; 
            }
        }
        
        .petal {
            position: fixed;
            width: 14px; 
            height: 14px;
            background: radial-gradient(ellipse at center, var(--primary-dark) 0%, var(--secondary-dark) 100%);
            border-radius: 50% 0 50% 0;
            pointer-events: none;
            opacity: 0.7; 
            animation: fallPetal linear infinite;
            box-shadow: 0 2px 5px color-mix(in srgb, var(--primary-dark) 50%, transparent);
        }

        @keyframes fallPetal {
            0% { 
                transform: translateY(-100px) rotate(0deg); 
                opacity: 0.1; 
            }
            15% { opacity: 0.8; }
            100% { 
                transform: translateY(100vh) rotate(1080deg); 
                opacity: 0.1; 
            }
        }

        @keyframes fadeInScale {
            from { 
                opacity: 0; 
                transform: scale(0.85) translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: scale(1) translateY(0); 
            }
        }
        
        .random-phrase {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: linear-gradient(135deg, color-mix(in srgb, var(--primary-light) 95%, transparent), color-mix(in srgb, var(--primary-dark) 95%, transparent));
            padding: 18px 28px;
            border-radius: 20px;
            font-size: 1rem;
            color: var(--secondary-dark);
            font-weight: 600;
            box-shadow: 
                0 8px 25px color-mix(in srgb, var(--secondary-dark) 40%, transparent),
                inset 0 1px 0 rgba(255, 255, 255, 0.5);
            z-index: 100;
            animation: phraseSlide 1.5s ease-out;
            max-width: 280px;
            border: 2px solid rgba(255, 255, 255, 0.5);
        }

        @keyframes phraseSlide {
            0% { transform: translateX(-350px) rotate(-5deg); opacity: 0; }
            60% { transform: translateX(10px) rotate(0deg); }
            100% { transform: translateX(0) rotate(0deg); opacity: 1; }
        }

        .music-toggle {
            position: fixed;
            top: 25px;
            right: 25px;
            background: linear-gradient(135deg, var(--secondary-dark), var(--primary-dark));
            color: white;
            border: none;
            padding: 18px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            z-index: 100;
            box-shadow: 
                0 8px 25px color-mix(in srgb, var(--secondary-dark) 50%, transparent),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
            transition: all 0.3s ease;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .music-toggle:hover {
            transform: scale(1.08) translateY(-2px);
            box-shadow: 0 12px 35px color-mix(in srgb, var(--secondary-dark) 60%, transparent);
        }

        .music-toggle:active {
            transform: scale(0.98);
        }

        /* Media Query para M√≥viles */
        @media (max-width: 600px) {
            h1 { font-size: 3rem; }
            h2 { font-size: 1.5rem; }
            p { font-size: 1rem; line-height: 1.8; margin-bottom: 30px; }
            .card-container { 
                padding: 35px 25px; 
                margin: 20px auto; 
                width: 95%; 
            }
            .map-container {
                height: 200px; /* ALTURA AJUSTADA PARA EL M√ìVIL */
                margin: 20px auto 10px auto;
            }
            .map-text {
                font-size: 1rem;
                margin: 15px auto 25px auto; /* ESPACIADO AJUSTADO */
            }
            .random-phrase { 
                font-size: 0.85rem; 
                padding: 12px 18px;
                max-width: 180px;
                bottom: 15px;
                left: 15px;
            }
            .music-toggle {
                padding: 12px 20px;
                font-size: 0.95rem;
                top: 15px;
                right: 15px;
            }
            .secret-message, .hysteresis-message {
                font-size: 0.55rem;
            }
        }
    </style>
</head>
<body>

<div class="secret-message">Nos vemos en enero 2026</div>

<div class="hysteresis-message">Agradezco a Dios que el 3/10/2006 a las 9:12 pm te haya dado la vida y a√∫n m√°s poder ser tu amigo.</div>


<audio id="birthday-audio" loop></audio>
<button class="music-toggle" id="musicBtn">‚è∏Ô∏è Pausar</button>

<div class="random-phrase" id="randomPhrase"></div>

<div class="card-container">
    <h1>¬°Feliz Cumplea√±os!</h1>
    <h2 id="personName">Mi Darling Adorada</h2>

    <p id="mainMessage"></p>

    <div class="map-container">
        <div class="world-map"></div>
    </div>
    
    <div class="map-text">4,758 km no son nada cuando la amistad es verdadera üíô</div>

    <p id="secondMessage"></p>
    
    <div class="signature">
        Con todo mi cari√±o, <br> JF
    </div>
</div>

<script>
    const songs = [
        "https://dl.dropboxusercontent.com/scl/fi/ehgsuyuy16kfxwz94ko0v/AUDIO-2025-09-30-20-46-11.mp3?rlkey=wf5t9wmdqzt6vcouoxykgnyh5",
        "https://dl.dropboxusercontent.com/scl/fi/t3tg9840c3n0haeiryk1s/AUDIO-2025-09-30-20-48-07.mp3?rlkey=m7bo5nf6sbq0lkqjio837rajo",
        "https://dl.dropboxusercontent.com/scl/fi/2m0dpurkrxryxsy3ipg7i/AUDIO-2025-09-30-20-48-52.mp3?rlkey=js57rle74kvswwam4la1ooy92",
        "https://dl.dropboxusercontent.com/scl/fi/ox7mgppj2jwlqgc8reqox/Manuel-Carrasco-Qu-Bonito-Es-Querer-Video-Oficial.mp3?rlkey=gs2qm1k6r9uf3uke2hnb3i54d&st=b286jtm2&dl=0", 
        "https://dl.dropboxusercontent.com/scl/fi/gf1fih936g0nny5vnpa0t/Jarabe-de-Palo-Eso-que-t-me-das-Videoclip-Oficial.mp3?rlkey=cjz7js8p0nasfvem78qbsvt6n&st=nk7d4wy5&dl=0",
        "https://www.dropbox.com/scl/fi/tgnxutosrnlkwyc7a8ssm/BAD-BUNNY-120-EL-LTIMO-TOUR-DEL-MUNDO-Visualizer.mp3?rlkey=zzoottr3qp1s7jjtwfketnwf2&st=1zg0zse4&dl=0"
    ];
    
    const colorThemes = [
        { l: '#e0f7fa', d: '#00bcd4', s: '#00897b', a: '#e91e63' }, 
        { l: '#f8bbd0', d: '#e91e63', s: '#c2185b', a: '#4db6ac' }, 
        { l: '#c8e6c9', d: '#4caf50', s: '#388e3c', a: '#ff9800' }, 
        { l: '#fff3e0', d: '#ffb74d', s: '#f57c00', a: '#039be5' },
        { l: '#e1bee7', d: '#9c27b0', s: '#7b1fa2', a: '#4dd0e1' }
    ];

    const titles = [
        "Mi Darling Adorada",
        "Mi Reina de Cali",
        "Mi Mejor Amiga",
        "Compa√±era de Vida",
        "Mi Alma Gemela",
        "Mi Persona Favorita",
        "Mi Hermana de Vida"
    ];

    const messages = [
        {
            main: "Hoy cumples 19 y recuerdo cuando nuestra amistad empez√≥ en **2021**; a veces me odiabas, a veces me amabas, ¬°una verdadera **monta√±a rusa de emociones**! Pero mira d√≥nde estamos. Eres mi persona favorita.",
            second: "Nuestra amistad ha sobrevivido a un continente y a **4,758 km** de distancia, lo cual demuestra que es a prueba de todo. Mereces toda la felicidad. ¬°Feliz cumplea√±os, Darling!"
        },
        {
            main: "19 a√±os de ti en este mundo. A pesar de los **miles de kil√≥metros** que nos separan, s√© que siempre est√°s ah√≠. Gracias por la confianza, la risa y por haber transformado esa 'enemistad' inicial en una hermandad incondicional.",
            second: "Que este a√±o te traiga las mismas alegr√≠as y la misma paz que t√∫ me das. Valoro infinitamente los momentos que hemos pasado juntos. ¬°Te adoro con el alma!"
        },
        {
            main: "A tus 19 a√±os has dejado una huella enorme. Nuestra amistad, que comenz√≥ con alguna fricci√≥n en **2021**, es la que m√°s atesoro. Es un viaje loco y hermoso, lleno de subidas y bajadas, como una **monta√±a rusa**.",
            second: "Estar√© aqu√≠ para animarte desde Chile. No importa la distancia, mi apoyo es total. Que este nuevo ciclo sea espectacular. ¬°Feliz cumplea√±os, mi mejor amiga!"
        },
        {
            main: "Hoy celebramos no solo tus 19 a√±os, sino la incre√≠ble historia de nuestra amistad. Desde esa √©poca 'oscura' en que **nos odi√°bamos** (ya sabes, la t√≠pica **monta√±a rusa**), hasta hoy, eres la persona m√°s leal que conozco.",
            second: "Que este a√±o te traiga grandes √©xitos y te aseguro que **4,758 km** es un detalle menor para el cari√±o que te tengo. ¬°Feliz cumplea√±os, mi compa√±era de vida!"
        },
        {
            main: "19 a√±os de pura luz. Desde el principio, nuestra amistad fue intensa, una **monta√±a rusa** de emociones que nos uni√≥ m√°s que a nadie. Has sido un apoyo incre√≠ble a pesar de vivir en otro pa√≠s.",
            second: "Gracias por cada videollamada y cada mensaje que acorta la distancia. Que la vida te d√© todo lo que so√±aste. Estar√© aqu√≠ para celebrar todo lo que viene. ¬°Te quiero mucho!"
        },
        {
            main: "19 a√±os de pura magia. Nuestra amistad es un viaje que empez√≥ en **2021**; una monta√±a rusa que ha forjado el mejor de los lazos. Has sido mi confidente y apoyo incondicional.",
            second: "Gracias por ser mi c√≥mplice. Que la vida te trate con la misma dulzura que t√∫ tratas al mundo. Mereces absolutamente todo lo bueno. ¬°Feliz cumplea√±os!"
        },
        {
            main: "A los 19 a√±os tienes toda una vida de posibilidades frente a ti, y yo estar√© aqu√≠, desde Chile, anim√°ndote en cada paso. Eres extraordinaria y me inspiras m√°s de lo que imaginas, incluso con la distancia.",
            second: "Que este a√±o te traiga claridad en tus metas y valent√≠a para perseguir tus sue√±os. Y recuerda, aunque estemos lejos, nuestra conexi√≥n trasciende los **4,758 km**. ¬°Feliz cumplea√±os! Te quiero much√≠simo."
        },
        {
            main: "Cumplir 19 nunca se hab√≠a visto tan radiante. Eres inteligente, hermosa y posees un coraz√≥n que no tiene comparaci√≥n. Me siento bendecido de compartir esta amistad contigo, a pesar de la distancia.",
            second: "Que este cumplea√±os sea el inicio de tu mejor a√±o hasta ahora. Que encuentres felicidad en cada d√≠a y que nunca olvides lo valiosa que eres. ¬°Feliz cumplea√±os, mi reina de Colombia!"
        },
        {
            main: "19 a√±os de tu siendo exactamente quien necesitas ser. Admiro tu autenticidad y esa capacidad tuya de hacer sentir especiales a quienes te rodean. Desde Copiap√≥ te mando todo mi cari√±o y mis mejores deseos.",
            second: "La distancia solo ha fortalecido nuestra amistad. Eres prueba viviente de que las conexiones verdaderas no se miden en kil√≥metros sino en momentos compartidos. ¬°Feliz cumplea√±os, Darling!"
        },
        {
            main: "Hoy el mundo celebra 19 a√±os de tu existencia, y yo celebro el privilegio de conocerte desde **2021**. Eres de esas personas que dejan huella, que hacen de este mundo un lugar mejor.",
            second: "Que este a√±o est√© lleno de oportunidades brillantes, de risas hasta que duela el est√≥mago y de momentos que te hagan sentir completamente viva. ¬°Feliz cumplea√±os! Te quiero con el alma."
        },
        {
            main: "¬°Feliz cumplea√±os, **Darling**! S√© que tu vida est√° a punto de dar un giro emocionante. Recuerda que siempre cuentas conmigo para celebrar cada paso, cada √©xito, y cada locura que se te ocurra.",
            second: "¬°Feliz cumplea√±os Darling ü§∞" 
        }
    ];

    const randomPhrases = [
        "¬øYa desayunaste hoy? ü•ê",
        "Toma aguita, la necesitas üíß",
        "¬°Eres incre√≠ble, en serio! ‚ú®",
        "¬øYa aprendiste a cocinar? üç≥",
        "Respira hondo, todo va bien üå¨Ô∏è",
        "Tu sonrisa ilumina el planeta üòä",
        "Mereces ser feliz siempre üåà",
        "¬øNo se te quemaron los huevos hoy? üòÇ",
        "Est√°s brillando m√°s que nunca ‚ú®",
        "La mejor amiga del mundo üèÜ",
        "Mereces todo lo bueno üí´",
        "¬øYa sabes lavar bien la losa? üßº",
        "Tu energ√≠a es contagiosa ‚ö°",
        "¬øYa te re√≠ste hoy? üòÑ",
        "¬°T√≥mate un descanso, lo mereces! ‚òï",
        "4,758 km y contando üåé",
        "¬°Hoy se vale todo el pastel! üç∞",
        "Te aprecio much√≠simo ü§ó",
        "Nuestra videollamada pendiente üìû",
        "La distancia no es nada üíô"
    ];

    let usedSongs = [];
    let usedMessages = [];

    function applyRandomTheme() {
        const theme = colorThemes[Math.floor(Math.random() * colorThemes.length)];
        const root = document.documentElement;
        root.style.setProperty('--primary-light', theme.l);
        root.style.setProperty('--primary-dark', theme.d);
        root.style.setProperty('--secondary-dark', theme.s);
        root.style.setProperty('--accent-color', theme.a);
        
        // Ajustar el color del mapa en SVG din√°micamente
        const mapStyle = document.createElement('style');
        mapStyle.textContent = `
            .world-map {
                background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 400"><path d="M150,150 Q400,100 650,180" stroke="${encodeURIComponent(theme.s)}" stroke-width="3" fill="none" stroke-dasharray="8,5" opacity="0.8"/><circle cx="150" cy="150" r="10" fill="${encodeURIComponent(theme.a)}" stroke="%23ffffff" stroke-width="2"/><circle cx="650" cy="180" r="10" fill="${encodeURIComponent(theme.a)}" stroke="%23ffffff" stroke-width="2"/><text x="150" y="130" font-size="16" fill="${encodeURIComponent(theme.s)}" text-anchor="middle" font-weight="700">Copiap√≥ üá®üá±</text><text x="650" y="205" font-size="16" fill="${encodeURIComponent(theme.s)}" text-anchor="middle" font-weight="700">Cali üá®üá¥</text><path d="M400,100 L410,105 L390,105 Z" fill="${encodeURIComponent(theme.a)}"/></svg>');
            }
        `;
        document.head.appendChild(mapStyle);
    }
    
    applyRandomTheme(); 

    function selectRandomElement(arr, usedArr) {
        let availableArr = arr.filter(el => !usedArr.includes(el));
        if (availableArr.length === 0) { 
            usedArr.length = 0; 
            availableArr = [...arr]; 
        }
        const randomIndex = Math.floor(Math.random() * availableArr.length);
        const randomElement = availableArr[randomIndex];
        usedArr.push(randomElement);
        return randomElement;
    }
    
    function selectRandomSong() {
        return selectRandomElement(songs, usedSongs);
    }

    function selectRandomMessage() {
        let availableIndices = [];
        for (let i = 0; i < messages.length; i++) {
            if (!usedMessages.includes(i)) { availableIndices.push(i); }
        }
        if (availableIndices.length === 0) {
            usedMessages = [];
            availableIndices = Array.from({length: messages.length}, (_, i) => i);
        }
        const randomIndex = availableIndices[Math.floor(Math.random() * availableIndices.length)];
        usedMessages.push(randomIndex);
        return messages[randomIndex];
    }

    
    const flowerEmojis = ['üåπ', 'üå∫', 'üíê', 'üå∑', 'üèµÔ∏è', 'üå∏', '‚ú®', 'üåü', 'üíõ', 'üíñ', 'üåº', 'ü•Ä'];
    
    let flowerInterval;
    let petalInterval;
    let flowerRate = 250; 
    let petalRate = 200; 

    function createFlower() {
        const flower = document.createElement('div');
        flower.classList.add('flower');
        flower.textContent = flowerEmojis[Math.floor(Math.random() * flowerEmojis.length)];
        flower.style.left = Math.random() * window.innerWidth + 'px';
        flower.style.animationDuration = (Math.random() * 5 + 6) + 's';
        flower.style.animationDelay = (-Math.random() * 3) + 's';
        document.body.appendChild(flower);
        setTimeout(() => { flower.remove(); }, 30000); 
    }

    function createPetal() {
        const petal = document.createElement('div');
        petal.classList.add('petal');
        petal.style.left = Math.random() * window.innerWidth + 'px';
        petal.style.animationDuration = (Math.random() * 4 + 5) + 's';
        petal.style.animationDelay = (-Math.random() * 4) + 's';
        
        const colors = [
            'radial-gradient(ellipse at center, var(--primary-dark) 0%, var(--secondary-dark) 100%)',
            'radial-gradient(ellipse at center, var(--primary-light) 0%, var(--primary-dark) 100%)',
            'radial-gradient(ellipse at center, var(--accent-color) 0%, var(--secondary-dark) 100%)'
        ];
        petal.style.background = colors[Math.floor(Math.random() * colors.length)];
        
        document.body.appendChild(petal);
        setTimeout(() => { petal.remove(); }, 25000);
    }
    
    function startFalling() {
        for (let i = 0; i < 60; i++) { createFlower(); }
        for (let i = 0; i < 80; i++) { createPetal(); }
        
        flowerInterval = setInterval(createFlower, flowerRate);
        petalInterval = setInterval(createPetal, petalRate);
    }

    function accelerateFalling() {
        console.log("¬°Acelerando la fiesta de fondo!");
        clearInterval(flowerInterval);
        clearInterval(petalInterval);
        
        flowerRate = 125; 
        petalRate = 100;   
        
        flowerInterval = setInterval(createFlower, flowerRate);
        petalInterval = setInterval(createPetal, petalRate);
    }
    
    startFalling();
    setTimeout(accelerateFalling, 180000); 

    // Asignar elementos din√°micos
    const selectedTitle = titles[Math.floor(Math.random() * titles.length)];
    document.getElementById('personName').textContent = selectedTitle;

    const selectedMessage = selectRandomMessage();
    document.getElementById('mainMessage').textContent = selectedMessage.main;
    document.getElementById('secondMessage').textContent = selectedMessage.second;

    const randomPhraseText = randomPhrases[Math.floor(Math.random() * randomPhrases.length)];
    document.getElementById('randomPhrase').textContent = randomPhraseText;

    const audio = document.getElementById('birthday-audio');
    const selectedSong = selectRandomSong();
    audio.src = selectedSong;

    let musicPlaying = false;
    const musicBtn = document.getElementById('musicBtn');

    function toggleMusic() {
        if (audio.paused && !musicPlaying) { 
            audio.play().then(() => {
                musicBtn.textContent = '‚è∏Ô∏è Pausar';
                musicPlaying = true;
            }).catch(e => {
                console.log("Reproducci√≥n bloqueada (toggle):", e);
                musicBtn.textContent = '‚ö†Ô∏è Toca para reproducir';
                musicPlaying = false;
            });
        } else if (musicPlaying) { 
            audio.pause();
            musicBtn.textContent = 'üéµ M√∫sica';
            musicPlaying = false;
        } else { 
             audio.play().then(() => {
                musicBtn.textContent = '‚è∏Ô∏è Pausar';
                musicPlaying = true;
            }).catch(e => {
                console.log("Reproducci√≥n bloqueada (toggle retry):", e);
                musicBtn.textContent = '‚ö†Ô∏è Toca para reproducir';
                musicPlaying = false;
            });
        }
    }

    musicBtn.addEventListener('click', toggleMusic);

    document.addEventListener('DOMContentLoaded', () => {
        const initialSong = selectRandomSong();
        audio.src = initialSong;
        
        audio.play().then(() => {
            musicBtn.textContent = '‚è∏Ô∏è Pausar';
            musicPlaying = true;
        }).catch(e => {
            console.log("Reproducci√≥n autom√°tica bloqueada. El usuario debe interactuar.");
            musicBtn.textContent = 'üéµ M√∫sica'; 
            musicPlaying = false;
        });
    });

    document.addEventListener('click', function autoPlayFallback() {
        if (!musicPlaying && audio.paused) {
            audio.play().then(() => {
                musicBtn.textContent = '‚è∏Ô∏è Pausar';
                musicPlaying = true;
            }).catch(e => {
                console.log("Fallback de reproducci√≥n bloqueado.");
                musicBtn.textContent = '‚ö†Ô∏è Toca para reproducir';
                musicPlaying = false;
            });
        }
    });

</script>

</body>
</html>